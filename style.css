:root{
  --crimson: #8B0000;
  --parchment: #f8efe0;
  --parchment-edge: #d9c6aa;
  --ink: #3d0a0a;
  --seal-dark: #6f0c12;
  --accent: #b35b4f;
}

/* base layout */
*{box-sizing:border-box}
html,body{height:100%;margin:0}
body{
  background: var(--crimson);
  font-family: 'Playfair Display', serif;
  -webkit-font-smoothing:antialiased;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:28px;
}

/* stage / scene */
.stage{width:100%;max-width:1100px;display:flex;justify-content:center}
.scene{display:flex;flex-direction:column;align-items:center;gap:20px;width:100%;}

/* envelope */
.envelope{
  position:relative;
  width:520px; /* mix of medium+large */
  max-width:92vw;
  height:320px;
  perspective:900px;
  display:flex;
  align-items:center;
  justify-content:center;
  transition:opacity 600ms cubic-bezier(.22,.9,.2,1), transform 600ms cubic-bezier(.22,.9,.2,1);
}

.envelope.hidden { opacity:0; transform:scale(.96); pointer-events:none; }

/* body of envelope */
.envelope .body{
  position:absolute;
  width:420px;
  height:240px;
  top:40px;
  background: linear-gradient(180deg,#fbf0d9,#f3e7cc);
  border-radius:10px;
  border:3px solid var(--accent);
  box-shadow: 0 12px 40px rgba(0,0,0,0.45);
  transform-origin:top center;
}

/* flap */
.envelope .flap{
  position:absolute;
  top:6px;
  width:460px;
  height:130px;
  background: linear-gradient(180deg,#f6e7c8,#ead8b1);
  border-radius:10px;
  border:3px solid var(--accent);
  transform-origin:top center;
  transform: translateY(-6px) rotateX(0deg);
  transition: transform 700ms cubic-bezier(.22,.9,.2,1);
  box-shadow: 0 18px 40px rgba(0,0,0,0.45);
}

/* when envelope.open -> flap lifts */
.envelope.open .flap{
  transform: translateY(-92px) rotateX(55deg);
}

/* seal button */
.seal{
  position:absolute;
  top:114px;
  left:50%;
  transform:translateX(-50%);
  width:96px;
  height:96px;
  border-radius:50%;
  border: 3px solid rgba(0,0,0,0.12);
  background: radial-gradient(circle at 30% 30%, #ff7b7b, #dc143c 35%, var(--seal-dark) 75%);
  display:flex;align-items:center;justify-content:center;
  z-index:8;
  cursor:pointer;
  box-shadow: 0 10px 30px rgba(0,0,0,0.45);
  transition: transform 260ms ease, box-shadow 260ms ease, opacity 300ms ease;
}

/* heartbeat */
@keyframes seal-beat {
  0%,100%{ transform:translateX(-50%) scale(1); }
  50%{ transform:translateX(-50%) scale(1.07); }
}
.seal.animate{ animation: seal-beat 1100ms infinite ease-in-out; }
.seal:hover{ animation-duration:420ms; transform:translateX(-50%) scale(1.06); box-shadow:0 16px 36px rgba(0,0,0,0.55); }

/* broken / fade */
.seal.broken{ opacity:0; transform:translateX(-50%) translateY(6px) scale(.92); pointer-events:none; }

/* parchment wrapper (hidden initially) */
.parchment-wrap{
  width:520px;
  max-width:92vw;
  display:flex;
  justify-content:center;
  pointer-events:none; /* becomes active when visible */
  transition:opacity 520ms cubic-bezier(.22,.9,.2,1);
  opacity:0;
}

/* parchment card */
.parchment{
  width:460px;
  max-width:86vw;
  height:520px; /* taller so plenty of room for message/buttons */
  background: linear-gradient(180deg,#fbf7ee,#f6ecd6);
  border-radius:10px;
  border: 3px solid var(--parchment-edge);
  box-shadow: 0 18px 60px rgba(0,0,0,0.45);
  transform: translateY(28px);
  transition: transform 750ms cubic-bezier(.22,.9,.2,1), box-shadow 400ms ease;
  overflow:hidden;
  pointer-events:auto;
}

/* when open, slide up and reveal */
.envelope.open ~ .parchment-wrap{ opacity:1; }
.envelope.open ~ .parchment-wrap .parchment{ transform: translateY(-10px); }

/* parchment inner content */
.parchment-content{
  padding:34px 36px;
  color:var(--ink);
  font-size:1.08rem;
  line-height:1.6;
  min-height:360px;
  display:flex;
  flex-direction:column;
  justify-content:space-between;
  font-family: 'Playfair Display', serif; /* less cursive, readable */
}

/* subtle paper stains */
.parchment::before{
  content:"";
  position:absolute;
  left:0;right:0;top:0;bottom:0;
  background:
    radial-gradient(600px 220px at 10% 12%, rgba(200,150,100,0.03), transparent 6%),
    radial-gradient(350px 140px at 88% 80%, rgba(200,150,100,0.02), transparent 8%);
  pointer-events:none;
}

/* typed message */
.message{ margin:0; white-space:pre-wrap; word-break:break-word; min-height:220px; }

/* choices */
.choices{ display:flex; justify-content:center; gap:12px; margin-top:12px; }
.choices.hidden{ display:none; }

.choice-btn{
  background: linear-gradient(90deg,#c92a2a,#ff6b6b);
  color:#fff; border:none; padding:12px 18px; border-radius:10px; cursor:pointer;
  box-shadow: 0 8px 20px rgba(0,0,0,0.18);
  font-size:1rem; transition: transform 140ms ease, box-shadow 180ms ease;
}
.choice-btn:hover{ transform:translateY(-4px); box-shadow:0 14px 30px rgba(0,0,0,0.28); }
.choice-btn:active{ transform:translateY(-2px) scale(.995); }

/* hint text */
.hint{ color:#fbe8d8; font-family: 'Great Vibes', cursive; opacity:0.95; font-size:1rem; }

/* responsive tweaks */
@media (max-width:640px){
  .envelope{ width:92vw; height:auto }
  .envelope .body{ width:82vw; height:40vh; top:38px }
  .parchment{ width:86vw; height:62vh }
  .parchment-content{ padding:20px }
  .parchment-content{ font-size:1rem }
  .seal{ width:82px;height:82px; top:100px }
}
